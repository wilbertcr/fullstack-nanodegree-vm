{"version":3,"sources":["Menu.jsx"],"names":[],"mappings":"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","file":"Menu-compiled.js","sourcesContent":["import React from 'react';\r\nimport MenuItems from './MenuItems';\r\nimport NewItemForm from './NewItemForm';\r\n\r\nexport default class Menu extends React.Component{\r\n    constructor(props){\r\n        super(props);\r\n        this.state = {data: []};\r\n        this.loadItemsFromServer = this.loadItemsFromServer.bind(this);\r\n        this.handleNewItemSubmit = this.handleNewItemSubmit.bind(this);\r\n        this.deleteMenuItem = this.deleteMenuItem.bind(this);\r\n    }\r\n\r\n    //Loads/refreshes menu items in display.\r\n    loadItemsFromServer(){\r\n        $.ajax({\r\n            url: this.props.url,\r\n            dataType:'json',\r\n            cache: false,\r\n            success: function(data){\r\n                this.setState({data: data.MenuItems});\r\n            }.bind(this),\r\n            error: function(xhr, status, err){\r\n                console.error(this.props.url, status, err.toString());\r\n            }.bind(this)\r\n        });\r\n    }\r\n    //Stores the new item in the server and updates the\r\n    //menu accordingly once the server has responded appropriately.\r\n    handleNewItemSubmit(item){\r\n        var restaurant = this.props.restaurant;\r\n        var MenuItems = this.state.data;\r\n        var endpoint = \"/restaurants/\"+restaurant.id+\"/menu/new\";\r\n        $.ajax({\r\n            url: endpoint,\r\n            dataType: 'json',\r\n            type: 'POST',\r\n            data: item,\r\n            success: function(data){\r\n                var NewItemWrapper = data['NewItem'];\r\n                var NewItem = NewItemWrapper[0];\r\n                var newMenuItems = MenuItems.concat([NewItem]);\r\n                this.setState({data: newMenuItems});\r\n            }.bind(this),\r\n            error: function(xhr,status,err){\r\n                console.error(endpoint,status,err.toString());\r\n            }.bind(this)\r\n        });\r\n    }\r\n\r\n\r\n    componentDidMount(){\r\n        this.loadItemsFromServer();\r\n        setInterval(this.loadItemsFromServer,this.props.pollInterval);\r\n    }\r\n\r\n    deleteMenuItem(e){\r\n        var key = parseInt(e.target.attributes.getNamedItem('data-key').value,10);\r\n        var index = parseInt(e.target.attributes.getNamedItem('data-index').value,10);\r\n        console.log(\"Erased menu item with key %d and index %d\",key,index);\r\n        this.setState({data: this.state.data.splice(index,1)});\r\n        var restaurant = this.props.restaurant;\r\n        var endpoint = \"/restaurants/\"+restaurant.id+\"/\"+key+\"/delete\";\r\n        $.ajax({\r\n            url: endpoint,\r\n            dataType: 'json',\r\n            type: 'POST',\r\n            data: key,\r\n            success: function(data){\r\n                this.setState({data: data.MenuItems});\r\n            }.bind(this),\r\n            error: function(xhr,status,err){\r\n                console.error(endpoint,status,err.toString());\r\n            }.bind(this)\r\n        });\r\n    }\r\n\r\n    render() {\r\n        var restaurant = this.props.restaurant;\r\n        return(\r\n            <div className=\"Menu\">\r\n                <h2>{restaurant.name+\"'s\"} Menu</h2>\r\n                <MenuItems data={this.state.data} deleteMenuItem={this.deleteMenuItem}/>\r\n                <NewItemForm onNewItemSubmit={this.handleNewItemSubmit}/>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n"]}